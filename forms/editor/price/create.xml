<?xml version="1.0" encoding="UTF-8"?>
<panel>
	<section labeli18n="modules.catalog.bo.doceditor.fieldsgroup.Amount-tax-validity">
		<field name="shopId" moduleselector="catalog" hidehelp="true" />
		<field name="boTaxCode" type="dropdownlist" required="true" listid="modules_catalog/taxcode"
			labeli18n="modules.catalog.document.price.TaxCode" hidehelp="true" />
		<field name="boValue" type="price" required="true" labeli18n="modules.catalog.document.price.Value" shorthelp="&amp;modules.catalog.document.price.Value-help;" hidehelp="true">
			<constraint name="min" parameter="0" />
		</field>
		<field name="ecoTax" />
		<field name="startpublicationdate" hidehelp="true" />
		<field name="endpublicationdate" hidehelp="true" />
	</section>
	<section labeli18n="modules.catalog.bo.doceditor.fieldsgroup.Discount">
		<row class="discountHelper" reference="catalog_price_create_boValue" pricefield="catalog_price_create_boDiscountValue" detailfield="catalog_price_create_discountDetail" />
		<field name="boDiscountValue" type="price" labeli18n="modules.catalog.document.price.DiscountValue" shorthelp="&amp;modules.catalog.document.price.DiscountValue-help;" hidehelp="true">
			<constraint name="min" parameter="0" />
		</field>
		<field name="discountDetail" />
	</section>
	<section labeli18n="modules.catalog.bo.doceditor.fieldsgroup.Restrictions">
		<field name="thresholdMin" />
		<field name="target" type="document" moduleselector="customer" allow="modules_customer_customer,modules_customer_tarifcustomergroup"
			labeli18n="modules.catalog.document.price.TargetId" shorthelp="&amp;modules.catalog.document.price.TargetId-help;" hidehelp="true" />
	</section>
	<xul>
		<javascript>
			<constructor><![CDATA[
				// Check customer module existence.
				var controller = document.getElementById("wcontroller");
    			if (!controller.checkModuleVersion('customer', '3.0.0'))
				{
					document.getAnonymousElementByAttribute(this, 'anonid', 'row_target').setAttribute('collapsed', 'true');
				}
			]]></constructor>
		
			<method name="prepareInitializeValues">
				<parameter name="attributes" />
				<body><![CDATA[
					var editor = this.documentEditor;
					if (editor.hasAttribute('shopId'))
					{
						attributes.shopId = editor.getAttribute('shopId');
						editor.removeAttribute('shopId');
					}
					if (editor.hasAttribute('targetId'))
					{
						attributes.targetId = editor.getAttribute('targetId');
						editor.removeAttribute('targetId');
					}
				]]></body>				
			</method>
			<method name="preparePropertiesValues">
				<parameter name="attributes" />
				<body><![CDATA[
					var fields = this.fields;
					attributes['shopId'] = fields.shopId.value;
					attributes['target'] = fields.target.value;
				]]></body>
			</method>
		</javascript>
	</xul>
</panel>