<script change:javascript="head 'modules.catalog.lib.js.product-detail'"></script>
<script tal:condition="baseconfiguration/getActivatezoom" change:javascript="head 'modules.catalog.lib.js.easyzoom'"></script>

<tal:block change:block="" module="order" name="CartMessages" container="" />
<tal:block change:block="" module="website" name="messages" container="" />

<h1 change:h="">${kititemproduct/getLabelAsHtml}</h1>

<dl class="inline-list">
	<dt>${trans:m.catalog.frontoffice.detail-reference,ucf}</dt>
	<dd>${kititemproduct/getCodeReferenceAsHtml}<span class="separator"> | </span></dd>
	<tal:block tal:condition="kititemproduct/hasPublishedBrand" tal:define="brand kititemproduct/getBrand">
		<dt>${trans:m.catalog.frontoffice.brand,ucf}</dt>
		<dd><a change:link="document brand">${brand/getLabelAsHtml}</a><span class="separator"> | </span></dd>
	</tal:block>
	<dt>${trans:m.catalog.fo.category,ucf}</dt>
	<dd><a change:link="document primaryshelf">${primaryshelf/getLabelAsHtml}</a></dd>
</dl>

<div class="columns">
	<tal:block tal:condition="declination">
		<tal:block tal:define="global visuals php: declination.getAllVisuals(shop); uniqueId declination/getId" />
	</tal:block>	
	<tal:block tal:condition="not: declination">
		<tal:block tal:define="global visuals php: kititemproduct.getAllVisuals(shop); uniqueId kititemproduct/getId" />
	</tal:block>
	<div class="column-66 product-pics">
		<ul class="main-visual">
			<li tal:repeat="visual visuals" id="product-visual-${uniqueId}-${visual/getId}">
				<script type="text/javascript" tal:condition="baseconfiguration/getActivatezoom">
					/* <![CDATA[ */
					jQuery(document).ready(function(){  
						jQuery('#product-visual-${uniqueId}-${visual/getId} a').easyZoom({
							id: 'product-zoom-${uniqueId}-${visual/getId}',
							parent: '#product-visual-${uniqueId}-${visual/getId}',
							preload: '<p class="preloader">${trans:m.catalog.fo.image-loading,ucf,js}</p>'
						});
					});
					/* ]]> */
				</script>
				<a tal:omit-tag="not:baseconfiguration/getActivatezoom" change:link="document visual"><img change:media="document visual; format 'modules.catalog.frontoffice/big'" /></a>
			</li>
		</ul>
		<ul class="inline-list additionnal-visuals" tal:condition="php: count(visuals) GT 1">
			<li tal:repeat="visual visuals" id="product-thumbnail-${uniqueId}-${visual/getId}" title="${trans:m.catalog.fo.click-here-for-larger-image,ucf}"><img change:media="document visual; format 'modules.catalog.frontoffice/small'" /></li>
		</ul>
	</div>
	<div class="column-33">
		<ul class="mini-navigation">
			<li><a change:link="document product; catalogParam[shopId] contextShopId; catalogParam[topicId] contextTopicId; catalogParam[customitems] customitems">${trans:m.catalog.frontoffice.go-to-kit,ucf,kitLabel=product/getLabelAsHtml}</a></li>
		</ul>
		<div class="cleaner"></div>
		<form class="cmxform" change:link="document product; catalogParam[customitems] customitems" method="post">
			<fieldset>
				<ol>
					<li>
						<input type="hidden" name="catalogParam[kititemid]" value="${kititem/getId}" />
						<label for="declination-selector-${context/getBlockId}">${trans:m.catalog.frontoffice.detail-declinations,ucf,lab}</label>
						<select tal:condition="declination" class="textfield" id="declination-selector-${context/getBlockId}" name="catalogParam[declinationid]" onchange="jQuery(this).parents('form').get(0).submit()">
							<tal:block tal:repeat="option php: kititemproduct.getPublishedDeclinationsInShop(shop)">
								<option tal:condition="php: option.getId() == declination.getId()" selected="selected" value="${option/getId}">${option/getLabelAsHtml}</option>
								<option tal:condition="php: option.getId() != declination.getId()" value="${option/getId}">${option/getLabelAsHtml}</option>
							</tal:block>
						</select>
					</li>
				</ol>
				<p class="buttons nojs">
					<input type="submit" class="button" value="${trans:m.catalog.frontoffice.refresh-declined,ucf,attr}" />
				</p>
			</fieldset>
		</form>
		<tal:block tal:condition="baseconfiguration/getShowShortDescription">
			<div tal:condition="product/getDescription" class="normal product-description">${php: product.getShortDescription(180)}</div>
		</tal:block>
	</div>
</div>